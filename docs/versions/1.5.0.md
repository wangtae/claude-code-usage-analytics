# Version 1.5.0

## Release Date
2025-10-27

## Summary
Weekly Limit Period 표시 문제를 해결하는 중요한 버그 수정

## Problem Fixed
Weekly mode에서 "Weekly Limit Period" 선택 시 기간이 잘못 표시되는 문제 해결:
- **이전**: Oct 21-27 (Recent 7 Days로 잘못된 폴백)
- **수정 후**: Oct 24-31 (올바른 Weekly Limit Period)

## Root Cause
`_parse_week_reset_date()` 함수의 정규식이 분(minute)이 포함된 시간 형식을 처리하지 못함:
- "Oct 31, 10am" ✓ (작동)
- "Oct 31, 9:59am" ✗ (파싱 실패 → Recent 7 Days로 폴백)

## Technical Details

### Changed Files
- `src/commands/usage.py`

### Specific Changes

#### 1. Regex Pattern Fix (line 233)
```python
# Before (broken)
date_match = re.search(r'([A-Za-z]+)\s+(\d+),\s+(\d+)(am|pm)', reset_no_tz)

# After (fixed)
date_match = re.search(r'([A-Za-z]+)\s+(\d+),\s+(\d+):?(\d*)(am|pm)', reset_no_tz)
```

#### 2. Parsing Logic Update (lines 237-240)
```python
# Before
hour = int(date_match.group(3))
meridiem = date_match.group(4)

# After
hour = int(date_match.group(3))
minute_str = date_match.group(4)
minute = int(minute_str) if minute_str else 0
meridiem = date_match.group(5)
```

#### 3. DateTime Creation Fix (line 255)
```python
# Before
local_dt = datetime(year, month_num, day, hour, 0, 0, tzinfo=tz)

# After
local_dt = datetime(year, month_num, day, hour, minute, 0, tzinfo=tz)
```

## Test Results
다양한 시간 형식 파싱 테스트:
- ✓ "Oct 31, 10am (Asia/Seoul)" → 2025-10-31 01:00:00
- ✓ "Oct 31, 9:59am (Asia/Seoul)" → 2025-10-31 00:59:00
- ✓ "Oct 31, 10:00am (Asia/Seoul)" → 2025-10-31 01:00:00
- ✓ "Oct 31, 9am (Asia/Seoul)" → 2025-10-31 00:00:00
- ✓ "Nov 1, 11:30pm (UTC)" → 2025-11-01 23:30:00

## User Impact
- Weekly mode의 "Weekly Limit Period"가 항상 올바른 기간을 표시
- 자동 새로고침 후에도 기간이 일관되게 유지됨
- `claude /usage` 출력 형식에 관계없이 안정적으로 작동

## Related Issues
- v1.4.8: Opus 비용 $0.00 표시 문제 해결
- v1.4.9: Weekly period 안정성 개선 시도 (부분적 해결)
- v1.5.0: 근본 원인 해결 (정규식 패턴 수정)

## Migration Notes
특별한 마이그레이션 작업 불필요. 업데이트 후 즉시 적용됨.