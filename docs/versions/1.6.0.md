# Version 1.6.0

**Release Date:** 2025-10-27

## âœ¨ New Features

### Weekly í˜ì´ì§€ì— "Recent 7 Days" ëª¨ë“œ ì¶”ê°€

Weekly í˜ì´ì§€ì— ìµœê·¼ 7ì¼ê°„ì˜ ì‚¬ìš©ëŸ‰ì„ ë³´ì—¬ì£¼ëŠ” ìƒˆë¡œìš´ í‘œì‹œ ëª¨ë“œë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.

**ê¸°ëŠ¥ ê°œìš”:**
- ì˜¤ëŠ˜ë¶€í„° 6ì¼ ì „ê¹Œì§€ ìµœê·¼ 7ì¼ê°„ì˜ ì‚¬ìš©ëŸ‰ì„ Rolling Window ë°©ì‹ìœ¼ë¡œ í‘œì‹œ
- Tab í‚¤ë¡œ 3ê°€ì§€ ëª¨ë“œ ìˆœí™˜: Weekly Limit Period â†’ Calendar Week â†’ Recent 7 Days
- ë³´ë¼ìƒ‰(magenta) ë©”ë‰´ ìƒ‰ìƒìœ¼ë¡œ êµ¬ë¶„

**3ê°€ì§€ Weekly í‘œì‹œ ëª¨ë“œ:**

1. **Weekly Limit Period (ë¹¨ê°„ìƒ‰)**: Claudeì˜ ì£¼ê°„ ì‚¬ìš© ì œí•œ ê¸°ê°„ (ì˜ˆ: ê¸ˆìš”ì¼ 9:59am ~ ë‹¤ìŒ ê¸ˆìš”ì¼ 9:58am)
2. **Calendar Week (ë…¸ë€ìƒ‰)**: ISO ë‹¬ë ¥ ì£¼ì°¨ (ì›”ìš”ì¼ ~ ì¼ìš”ì¼)
3. **Recent 7 Days (ë³´ë¼ìƒ‰)**: ìµœê·¼ 7ì¼ (ì˜¤ëŠ˜ í¬í•¨, Rolling window)

**ì‚¬ìš© ë°©ë²•:**
```bash
ccu                # ì‹¤í–‰
w                  # Weekly í˜ì´ì§€ë¡œ ì´ë™
Tab                # ëª¨ë“œ ì „í™˜ (Limit Period â†’ Calendar â†’ Recent 7 Days)
```

**í™”ë©´ êµ¬ì„±:**
- KPI ì„¹ì…˜: ìµœê·¼ 7ì¼ ì´ ì‚¬ìš©ëŸ‰ (í† í°, ë¹„ìš©, ë©”ì‹œì§€ ìˆ˜ ë“±)
- Model Breakdown: ëª¨ë¸ë³„ ì‚¬ìš©ëŸ‰ í†µê³„
- Project Breakdown: í”„ë¡œì íŠ¸ë³„ ì‚¬ìš©ëŸ‰ í†µê³„
- Daily Usage: 7ì¼ ì¼ë³„ ìƒì„¸ ë‚´ì—­ (ë‚ ì§œ, í† í°, ë¹„ìœ¨, ë¹„ìš©)

## ğŸ› Bug Fixes

### Weekly Recent 7 Days ëª¨ë“œì˜ ë¹„ìš© ê³„ì‚° ì •í™•ë„ ê°œì„ 

Monthlyì˜ Daily Usageì™€ Weeklyì˜ Recent 7 Days ëª¨ë“œì—ì„œ ê°™ì€ ë‚ ì§œì— ëŒ€í•´ ë‹¤ë¥¸ ë¹„ìš©ì´ í‘œì‹œë˜ë˜ ë¬¸ì œë¥¼ í•´ê²°í–ˆìŠµë‹ˆë‹¤.

**ë¬¸ì œ ì›ì¸:**
1. Weekly modeì—ì„œ recordsë¥¼ ì£¼ê°„ limit periodë¡œ ë¨¼ì € í•„í„°ë§
2. Recent 7 Days í•¨ìˆ˜ê°€ ì´ë¯¸ í•„í„°ë§ëœ ë°ì´í„°ë¥¼ ë‹¤ì‹œ 7ì¼ë¡œ í•„í„°ë§
3. ê²°ê³¼ì ìœ¼ë¡œ ì´ì¤‘ í•„í„°ë§ìœ¼ë¡œ ì¼ë¶€ ë‚ ì§œ ë°ì´í„° ëˆ„ë½

**í•´ê²° ë°©ë²•:**
- `load_last_n_days_records(days=7)` í•¨ìˆ˜ ì‹ ê·œ ì¶”ê°€
- Recent 7 Days ëª¨ë“œì¼ ë•Œ ì „ì²´ ë°ì´í„°ì—ì„œ ì§ì ‘ ìµœê·¼ 7ì¼ë§Œ ë¡œë“œ
- ì´ì¤‘ í•„í„°ë§ ë°©ì§€ ë¡œì§ ì¶”ê°€

**ì˜í–¥ë°›ëŠ” íŒŒì¼:**
- `src/storage/snapshot_db.py`: `load_last_n_days_records()` í•¨ìˆ˜ ì¶”ê°€
- `src/commands/usage.py`: Recent 7 Days ëª¨ë“œ ì „ìš© ë ˆì½”ë“œ ë¡œë”© ë¡œì§
- `src/visualization/dashboard.py`: Recent 7 Days ë Œë”ë§ í•¨ìˆ˜ ì¶”ê°€

## ğŸ”§ Technical Implementation

### ìƒˆë¡œ ì¶”ê°€ëœ í•¨ìˆ˜

**1. `load_last_n_days_records(days: int = 7)` - snapshot_db.py**
```python
def load_last_n_days_records(days: int = 7) -> list[UsageRecord]:
    """ì •í™•íˆ ìµœê·¼ Nì¼ì˜ ë ˆì½”ë“œë§Œ ë¡œë“œ"""
    today = datetime.now(timezone.utc).date()
    cutoff_date = (today - timedelta(days=days-1)).strftime("%Y-%m-%d")

    all_records = load_all_devices_historical_records_cached()
    recent_records = [record for record in all_records if record.date_key >= cutoff_date]
    return recent_records
```

**2. `_create_daily_breakdown_recent7(records)` - dashboard.py**
- Calendar Week í•¨ìˆ˜ì™€ ë™ì¼í•œ í˜•ì‹
- ìµœê·¼ 7ì¼ ë°ì´í„°ë§Œ í•„í„°ë§í•˜ì—¬ í‘œì‹œ
- ë‚ ì§œ, í† í°, ë¹„ìœ¨, ë¹„ìš©ì„ ë§‰ëŒ€ ê·¸ë˜í”„ì™€ í•¨ê»˜ í‘œì‹œ

### í‚¤ë³´ë“œ í•¸ë“¤ëŸ¬ ì—…ë°ì´íŠ¸

**usage.py - Tab í‚¤ ë™ì‘ ë³€ê²½:**
```python
# ë³€ê²½ ì „: limits â†” calendar (2ê°œ í† ê¸€)
weekly_display_mode = 'calendar' if current == 'limits' else 'limits'

# ë³€ê²½ í›„: limits â†’ calendar â†’ recent7 â†’ limits (3ê°œ ìˆœí™˜)
if current == 'limits':
    weekly_display_mode = 'calendar'
elif current == 'calendar':
    weekly_display_mode = 'recent7'
else:  # recent7
    weekly_display_mode = 'limits'
```

### Footer ë©”ë‰´ ìƒ‰ìƒ

**dashboard.py - ëª¨ë“œë³„ ìƒ‰ìƒ êµ¬ë¶„:**
- Weekly Limit Period: `black on bright_red`
- Calendar Week: `black on yellow`
- Recent 7 Days: `black on magenta` (ì‹ ê·œ)

### ë°ì´í„° ë¡œë”© ìµœì í™”

**usage.py - ëª¨ë“œë³„ ìµœì í™”ëœ ë ˆì½”ë“œ ë¡œë”©:**
```python
def _load_records_for_view() -> list:
    if view_mode == VIEW_MODE_WEEKLY and weekly_display_mode == 'recent7':
        return load_last_n_days_records(days=7)  # 7ì¼ë§Œ ë¡œë“œ
    elif view_mode in {VIEW_MODE_WEEKLY, VIEW_MODE_MONTHLY, ...}:
        return load_all_devices_historical_records_cached()  # ì „ì²´ ë¡œë“œ
    return load_recent_usage_records()  # ì´ë²ˆ ë‹¬ ë¡œë“œ
```

## ğŸ“ Changed Files

### ì‹ ê·œ íŒŒì¼
- `docs/versions/1.6.0.md`: ë²„ì „ ë¬¸ì„œ

### ìˆ˜ì •ëœ íŒŒì¼
- `src/commands/usage.py`:
  - Recent 7 Days ëª¨ë“œ ì¶”ê°€ (í‚¤ë³´ë“œ í•¸ë“¤ëŸ¬)
  - `load_last_n_days_records` import
  - `_load_records_for_view()` ë¡œì§ ê°œì„ 
  - Weekly í•„í„°ë§ ê±´ë„ˆë›°ê¸° ë¡œì§ ì¶”ê°€

- `src/visualization/dashboard.py`:
  - `_create_daily_breakdown_recent7()` í•¨ìˆ˜ ì¶”ê°€
  - Recent 7 Days ë Œë”ë§ ë¡œì§ ì¶”ê°€
  - Footer ë©”ë‰´ ìƒ‰ìƒ ì¶”ê°€ (magenta)
  - ëª¨ë“œ ì´ë¦„ í‘œì‹œ ë¡œì§ ì—…ë°ì´íŠ¸

- `src/storage/snapshot_db.py`:
  - `load_last_n_days_records(days=7)` í•¨ìˆ˜ ì¶”ê°€

- `pyproject.toml`:
  - ë²„ì „ 1.5.1 â†’ 1.6.0

## ğŸ”„ Migration Notes

ì´ ë²„ì „ì€ í•˜ìœ„ í˜¸í™˜ì„±ì„ ìœ ì§€í•©ë‹ˆë‹¤.

**ì—…ê·¸ë ˆì´ë“œ ë°©ë²•:**
```bash
# Pipx ì‚¬ìš© ì‹œ
pipx upgrade claude-code-usage-analytics

# ë˜ëŠ” ê°œë°œ ëª¨ë“œ ì¬ì„¤ì¹˜
cd /path/to/claude-code-usage-analytics
pipx install -e . --force
```

**ë°ì´í„°ë² ì´ìŠ¤ í˜¸í™˜ì„±:**
- ê¸°ì¡´ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì—†ìŒ
- ê¸°ì¡´ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ë¶ˆí•„ìš”
- ì„¤ì • íŒŒì¼ ë³€ê²½ ì—†ìŒ

## ğŸ’¡ Usage Tips

**Recent 7 Days ëª¨ë“œ í™œìš©:**
- ìµœê·¼ ì‚¬ìš© íŒ¨í„´ì„ ë¹ ë¥´ê²Œ íŒŒì•…í•  ë•Œ ìœ ìš©
- ì£¼ê°„ ì œí•œê³¼ ë¬´ê´€í•˜ê²Œ ìˆœìˆ˜í•˜ê²Œ ìµœê·¼ 7ì¼ë§Œ ë³´ê³  ì‹¶ì„ ë•Œ
- Monthly ëª¨ë“œì™€ ë¹„êµí•˜ì—¬ ê°™ì€ ë‚ ì§œì˜ ì •í™•í•œ ë¹„ìš© í™•ì¸ ê°€ëŠ¥

**ëª¨ë“œ ë¹„êµ:**
- **Limit Period**: ì£¼ê°„ ì œí•œ ê´€ë¦¬ì— ìµœì  (Claude ê³µì‹ ë¦¬ì…‹ ì£¼ê¸°)
- **Calendar Week**: ì£¼ê°„ ë³´ê³ ì„œ ì‘ì„±ì— ìµœì  (ì›”~ì¼ ê¸°ì¤€)
- **Recent 7 Days**: ìµœê·¼ íŠ¸ë Œë“œ ë¶„ì„ì— ìµœì  (Rolling window)

## ğŸ¯ Next Steps

í–¥í›„ ë²„ì „ì—ì„œ ê³ ë ¤í•  ì‚¬í•­:
- Recent N Days ëª¨ë“œì—ì„œ Nì„ ì‚¬ìš©ìê°€ ì§€ì • ê°€ëŠ¥í•˜ë„ë¡ ê°œì„ 
- Weekly ëª¨ë“œ ê°„ ì „í™˜ ì‹œ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ ì¶”ê°€
- ëª¨ë“œë³„ ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥ ì¶”ê°€
