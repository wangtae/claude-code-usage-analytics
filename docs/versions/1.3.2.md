# Version 1.3.2

**Release Date**: 2025-10-21

## Bug Fixes

### Fixed Display Errors in Weekly View
- **Fixed incorrect data display when returning from detail views**
- **Fixed wrong week dates when initially switching to weekly view**

## Changes

### Cache Invalidation Improvements
- Added forced data refresh when exiting from daily detail or hourly detail views
- Prevents stale or incorrect data from being displayed
- Ensures accurate data after viewing detailed breakdowns

### Weekly View Initialization Fix
- Forces data refresh when switching to weekly view
- Fixes issue where wrong week dates (October 14-21 instead of current week) were shown
- Ensures correct week limit period is displayed on first load

## Technical Details

### Files Modified
- `src/commands/usage.py`
  - Added `force_data_refresh` flag for detail view transitions
  - Forces data refresh when switching to weekly view
  - Improved cache management for view transitions

### Problem Symptoms (Now Fixed)
1. When entering daily detail (1-8 keys) or message detail and returning with ESC:
   - Wrong dates displayed (e.g., showing October 14 when current date is October 21)
   - Incorrect token counts (showing 1.0bn instead of actual values)
   - Data only corrected after auto-refresh (30 seconds)

2. When first switching to weekly view after program start:
   - Wrong week dates displayed
   - Had to wait for auto-refresh to see correct data

### Solution
- Forces fresh data load instead of using cached data when:
  - Exiting from any detail view
  - Initially switching to weekly view
- Regular view transitions (u, m, y, etc.) still use cached data for speed

## Compatibility

No breaking changes. This is a bug fix that improves data accuracy in the UI.